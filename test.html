<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Basic Meta Tags -->
    <meta property="og:title" content="Sleep Duelist - Yu-Gi-Oh! Quiz" />
    <meta property="og:description" content="Guess between real and fake card names, test your knowledge of Yu-Gi-Oh! cards." />
    <meta property="og:url" content="https://www.sleepyduelist.xyz" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://i.imgur.com/pRmoNc8.png" />
    <meta property="og:image:alt" content="Preview of website homescreen" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Sleepy Duelist" />
    
    <!-- Twitter Card Tags (optional but recommended) -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="-" />
    <meta name="twitter:title" content="Sleepy Duelist" />
    <meta name="twitter:description" content="Guess between real and fake card names, test your knowledge of Yu-Gi-Oh! cards." />
    <meta name="twitter:image" content="https://i.imgur.com/pRmoNc8.png" />
    <meta name="twitter:image:alt" content="Preview of website homescreen" />
    
    <!-- Additional Meta Tags for SEO (optional) -->
    <meta name="description" content="Guess between real and fake card names, test your knowledge of Yu-Gi-Oh! cards." />
    <meta name="author" content="Volts" />

    <title>Real or Fake: Yu-Gi-Oh!</title>
    <style>
        /* CSS Styles - Dark Magician Girl Theme */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #f2e6ff; /* Light lavender background */
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        header {
            background-color: #9370db; /* Medium purple */
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            box-shadow: 0 4px 8px rgba(147, 112, 219, 0.3);
        }

        /* Header buttons styles */
        .header-buttons {
            display: flex;
            gap: 10px;
        }
        
        .header-btn {
            background-color: #ffb7c5; /* Light pink */
            color: #5a3b76; /* Dark purple */
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            text-decoration: none;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(255, 183, 197, 0.3);
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .header-btn:hover {
            background-color: #ff9eb5; /* Slightly darker pink */
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(255, 183, 197, 0.5);
        }
        
        /* Dark theme for header buttons */
        body.dark-theme .header-btn {
            background-color: #d8b5ff; /* Light purple */
            color: #3a2158; /* Dark purple */
            box-shadow: 0 2px 4px rgba(216, 181, 255, 0.3);
        }
        
        body.dark-theme .header-btn:hover {
            background-color: #c6a0fc; /* Slightly darker light purple */
        }
        
        main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .home-container {
            text-align: center;
            max-width: 600px;
        }
        
        .home-title {
            font-size: 3rem;
            margin-bottom: 2rem;
            color: #ff85a2; /* Soft pink */
        }
        
        .difficulty-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        .difficulty-btn {
            background-color: #ffb7c5; /* Light pink */
            color: #5a3b76; /* Dark purple */
            padding: 0.8rem 1.5rem;
            font-size: 1.2rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(255, 183, 197, 0.3);
        }
        
        .difficulty-btn:hover {
            background-color: #ff9eb5; /* Slightly darker pink */
            transform: translateY(-3px);
        }
        
        .difficulty-btn.active {
            background-color: #9370db; /* Medium purple */
            color: white;
            transform: scale(1.05);
        }
        
        .begin-btn {
            display: inline-block;
            background-color: #9370db; /* Medium purple */
            color: white;
            padding: 1rem 3rem;
            font-size: 1.5rem;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(147, 112, 219, 0.4);
            border: none;
            cursor: pointer;
        }
        
        .begin-btn:hover {
            background-color: #8465be; /* Slightly darker purple */
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(147, 112, 219, 0.6);
        }
        
        .begin-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(147, 112, 219, 0.4);
        }
        
        /* Styles for the selection page */
        .game-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1200px;
        }
        
        .selection-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2rem;
            width: 100%;
            margin-bottom: 2rem;
        }
        
        .selection-box {
            background-color: #e6f2ff; /* Light blue */
            padding: 2.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(147, 112, 219, 0.25);
            width: 100%;
            max-width: 350px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 2px solid #d8b5ff; /* Light purple border */
        }
        
        .selection-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(147, 112, 219, 0.4);
            border-color: #9370db; /* Medium purple border on hover */
        }
        
        .selection-box h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #9370db; /* Medium purple */
        }
        
        .selection-box p {
            font-size: 1.6rem;
            margin-bottom: 1rem;
            font-weight: bold;
            color: #5a3b76; /* Dark purple */
        }
        
        /* UPDATED: More prominent score display */
        .score-display {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ffcc99; /* Soft gold */
            color: #5a3b76; /* Dark purple */
            padding: 0.8rem 2rem;
            border-radius: 0.5rem;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(255, 204, 153, 0.5);
            font-size: 1.5rem;
            z-index: 100;
        }
        
        .difficulty-display {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #ff85a2; /* Soft pink */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(255, 133, 162, 0.4);
        }
        
        /* UPDATED: Lives container positioned below choices */
        .lives-container {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-top: 1rem;
            margin-bottom: 2rem;
            gap: 1rem;
            text-align: center;
        }
        
        .life {
            color: #ff85a2; /* Soft pink */
            font-size: 2rem;
            filter: drop-shadow(0 2px 4px rgba(255, 133, 162, 0.4));
        }
        
        .menu-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: #9370db; /* Medium purple */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(147, 112, 219, 0.4);
            cursor: pointer;
            border: none;
            transition: background-color 0.3s;
        }
        
        .menu-btn:hover {
            background-color: #8465be; /* Slightly darker purple */
        }
        
        /* ADDED: Last score display on home screen */
        .last-score {
            margin: 1.5rem 0;
            padding: 1rem;
            background-color: #ffebcc; /* Very light gold */
            border-radius: 0.5rem;
            box-shadow: 0 2px 6px rgba(255, 204, 153, 0.4);
            color: #996633; /* Dark gold */
            font-weight: bold;
            font-size: 1.2rem;
            display: none; /* Hidden initially */
            border: 1px solid #ffcc99; /* Light gold border */
        }
        
        footer {
            background-color: #9370db; /* Medium purple */
            color: white;
            text-align: center;
            padding: 1.5rem 0;
            margin-top: auto;
            box-shadow: 0 -4px 8px rgba(147, 112, 219, 0.3);
        }
        
        /* Dark theme - Now Dark Magician Girl night theme */
        body.dark-theme {
            background-color: #2e1c45; /* Dark purple background */
            color: #e6f2ff; /* Light blue text */
        }
        
        body.dark-theme .home-title {
            color: #ffb7c5; /* Light pink */
        }
        
        body.dark-theme .selection-box {
            background-color: #3a2158; /* Slightly lighter purple */
            color: #e6f2ff; /* Light blue text */
            border-color: #9370db; /* Medium purple border */
        }
        
        body.dark-theme .selection-box h2 {
            color: #d8b5ff; /* Light purple */
        }
        
        body.dark-theme .selection-box p {
            color: #e6f2ff; /* Light blue text */
        }
        
        /* Updated dark theme for last score */
        body.dark-theme .last-score {
            background-color: #43275a; /* Deep purple */
            color: #ffcc99; /* Soft gold */
            border-color: #9370db; /* Medium purple */
        }
        
        /* Theme toggle */
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #9370db; /* Medium purple */
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(147, 112, 219, 0.6);
            transition: background-color 0.3s;
            z-index: 100;
        }
        
        .theme-toggle:hover {
            background-color: #8465be; /* Slightly darker purple */
        }
        
        /* Feedback notification styles */
        .notification {
            position: fixed;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(147, 112, 219, 0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }
        
        .notification.success {
            background-color: #9ee2a2; /* Pastel green */
            color: #2e6934; /* Dark green */
        }
        
        .notification.error {
            background-color: #ffb7c5; /* Light pink */
            color: #993344; /* Dark pink */
        }
        
        .notification.show {
            opacity: 1;
        }
        
        /* Game over overlay */
        .game-over-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(46, 28, 69, 0.9); /* Dark purple with transparency */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .game-over-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .game-over-content {
            background-color: #e6f2ff; /* Light blue */
            padding: 3rem;
            border-radius: 10px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 6px 24px rgba(147, 112, 219, 0.6);
            border: 3px solid #ffcc99; /* Soft gold border */
        }
        
        .game-over-content h2 {
            font-size: 2.5rem;
            color: #ff85a2; /* Soft pink */
            margin-bottom: 1.5rem;
        }
        
        .game-over-content p {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            color: #5a3b76; /* Dark purple */
        }
        
        .game-over-content .difficulty-played {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: #9370db; /* Medium purple */
            font-weight: bold;
        }
        
        .play-again-btn {
            background-color: #9370db; /* Medium purple */
            color: white;
            padding: 0.8rem 2rem;
            font-size: 1.2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 3px 8px rgba(147, 112, 219, 0.4);
        }
        
        .play-again-btn:hover {
            background-color: #8465be; /* Slightly darker purple */
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(147, 112, 219, 0.6);
        }
        
        body.dark-theme .game-over-content {
            background-color: #3a2158; /* Slightly lighter purple */
            color: #e6f2ff; /* Light blue text */
            border-color: #ffb7c5; /* Light pink border */
        }
        

        .share-score-btn {
                background-color: #ffb7c5; /* Light pink */
                color: #5a3b76; /* Dark purple */
                padding: 0.8rem 2rem;
                font-size: 1.2rem;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                transition: background-color 0.3s, transform 0.2s;
                box-shadow: 0 3px 8px rgba(255, 183, 197, 0.4);
                margin-left: 10px;
            }

            .share-score-btn:hover {
                background-color: #ff9eb5; /* Slightly darker pink */
                transform: translateY(-2px);
                box-shadow: 0 5px 12px rgba(255, 183, 197, 0.6);
            }

            body.dark-theme .share-score-btn {
                background-color: #d8b5ff; /* Light purple */
                color: #3a2158; /* Dark purple */
                box-shadow: 0 3px 8px rgba(216, 181, 255, 0.4);
            }

            body.dark-theme .share-score-btn:hover {
                background-color: #c6a0fc; /* Slightly darker light purple */
            }

            /* Style for the copy notification */
            .copy-notification {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: rgba(147, 112, 219, 0.9);
                color: white;
                padding: 15px 30px;
                border-radius: 8px;
                font-weight: bold;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
                z-index: 3000;
                opacity: 0;
                visibility: hidden;
                transition: opacity 0.3s, visibility 0.3s;
            }

            .copy-notification.show {
                opacity: 1;
                visibility: visible;
            }


        /* Responsive design - Also do not add any CSS below this comment lmao */
        
        /* Enhanced Mobile Responsiveness for Sleepy Duelist */

        /* General layout improvements */
        @media (max-width: 768px) {
            /* Adjust header layout */
            header div {
                flex-direction: column;
                gap: 10px;
            }

            header {
                padding: 0.8rem 0;
            }

            header h1 {
                font-size: 1.5rem;
                margin-top: 10px;
            }
            
            .header-buttons {
                width: 100%;
                justify-content: center;
            }
            
            .selection-box {
                padding: 2rem;
                max-width: 100%;
            }
            
            .selection-container {
                gap: 10px; /* Reduced gap between options */
            }
            
            .score-display {
                top: 130px;
                font-size: 1.2rem;
                padding: 0.6rem 1.5rem;
            }
            
            /* Home page adjustments */
            .home-title {
                font-size: 2rem;
                margin-bottom: 1rem;
            }

            .home-container p {
                margin-bottom: 0.8rem; /* Reduced margin */
            }
            
            .gif-container img {
                margin-bottom: 0.8rem; /* Reduced margin */
            }
            
            .gif-container img {
                max-height: 150px; /* Limit height of GIF */
            }

            .difficulty-container {
                gap: 8px; /* Reduced gap between difficulty buttons */
                margin: 1rem 0; /* Reduced margin */
            }
            
            .difficulty-btn {
                padding: 0.6rem 1rem;
                font-size: 1rem;
            }
            
            .begin-btn {
                padding: 0.8rem 2rem;
                font-size: 1rem;
                margin-top: 1rem;
            }
            
            /* Game layout improvements */
            .score-display {
                position: static;
                transform: none;
                padding: 0.5rem 1.2rem;
                margin: 5px auto;
                width: 90%;
                max-width: 300px;
            }
            
            .difficulty-display {
                position: static;
                padding: 0.4rem 1rem;
                margin: 5px auto 10px;
                width: 90%;
                max-width: 300px;
            }
            
            .menu-btn {
                position: static;
                display: block;
                margin: 5px auto;
                width: 90%;
                max-width: 300px;
            }
            
            .game-content {
                margin-top: 10px;
            }
            
            /* Fix the lives container on mobile */
            .lives-container {
                margin-top: 0.3rem;
                margin-bottom: 1rem;
            }
            
            main {
                padding: 1rem; /* Reduced padding */
            }

            /* Improve selection boxes for touch */
            .selection-box {
                padding: 1.4rem 1rem;
                margin-bottom: 10px;
                min-height: 60px;
                display: flex;
                justify-content: center;
                align-items: center;
                width: 90%;
            }
            
            .selection-box p {
                font-size: 1.4rem;
                margin-bottom: 0;
            }
            
            /* Game over overlay */
            .game-over-content {
                width: 90%;
                padding: 2rem 1.5rem;
            }
            
            .game-over-content h2 {
                font-size: 2rem;
            }
            
            /* Adjust button positioning */
            .play-again-btn, .share-score-btn {
                margin: 10px 5px;
                padding: 0.8rem 1.2rem;
            }
            
            /* Position theme toggle better */
            .theme-toggle {
                bottom: 80px;
                right: 15px;
                width: 45px;
                height: 45px;
            }
            
            /* Notification positioning */
            .notification {
                width: 90%;
                padding: 10px 15px;
            }

            
        }

        /* Extra small devices */
        @media (max-width: 480px) {
            header h1 {
                font-size: 1.5rem;
            }
            
            .header-btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .home-title {
                font-size: 1.8rem;
            }
            
            .difficulty-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .selection-box p {
                font-size: 1.2rem;
            }
            
            .game-over-content h2 {
                font-size: 1.8rem;
            }
            
            .play-again-btn, .share-score-btn {
                display: block;
                width: 90%;
                max-width: 200px;
                margin: 10px auto;
            }
            
            /* Adjust notification and copy popup size */
            .notification, .copy-notification {
                font-size: 0.9rem;
                padding: 12px;
            }
            
            /* Better footer text scaling */
            footer small {
                font-size: 0.75rem;
                padding: 0 10px;
                display: block;
            }
        }

        /* Fix for iOS Safari viewport height issues */
        @supports (-webkit-touch-callout: none) {
            body, html {
                height: -webkit-fill-available;
            }
            
            body {
                min-height: -webkit-fill-available;
            }
            
            main {
                min-height: 70vh;
                min-height: -webkit-fill-available;
            }
        }

        /* Additional styles for touchscreen devices */
        /* General touch-friendly improvements */
        .touchscreen button, 
        .touchscreen .selection-box, 
        .touchscreen .header-btn {
            cursor: pointer;
            -webkit-tap-highlight-color: transparent; /* Remove default highlight on tap */
            touch-action: manipulation; /* Disable double-tap zoom */
        }

        /* Active state styling for touch feedback */
        .touchscreen button.button-active, 
        .touchscreen .selection-box.button-active,
        .touchscreen .header-btn.button-active {
            transform: scale(0.97);
            opacity: 0.9;
            transition: transform 0.1s ease-in-out, opacity 0.1s ease-in-out;
        }

        /* Adjusted spacing for touch targets */
        .touchscreen .selection-box {
            margin-bottom: 15px;
        }

        .touchscreen .difficulty-btn {
            min-width: 90px;
            min-height: 44px; /* Apple's recommended minimum for touch targets */
        }

        /* Fix for fixed positioning on mobile */
        .touchscreen .game-over-overlay {
            position: fixed;
            height: 100%;
            height: calc(var(--vh, 1vh) * 100);
        }

        /* Fix iOS momentum scrolling */
        .touchscreen {
            -webkit-overflow-scrolling: touch;
        }

        /* Stacked mobile layout for game controls */
        @media (max-width: 768px) {
            .mobile-controls-container {
                display: flex;
                flex-direction: column;
                gap: 10px;
                width: 100%;
                margin-bottom: 15px;
            }
            
            /* Redesigned score display for mobile */
            .touchscreen .score-display {
                border-radius: 8px;
                box-shadow: 0 2px 6px rgba(255, 204, 153, 0.4);
            }
            
            /* Ensure buttons are spaced properly on touch devices */
            .touchscreen .play-again-btn,
            .touchscreen .share-score-btn {
                margin: 8px;
                min-height: 50px;  /* Larger touch target */
            }
            
            /* Prevent text selection on mobile */
            .touchscreen .selection-box p {
                user-select: none;
                -webkit-user-select: none;
            }
        }

    </style>
    <!-- Import the external card lists JavaScript file -->
    <script src="cardLists.js"></script>
</head>
<body>
    <header>
        <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; width: 100%;">
            <div class="header-buttons">
                <a href="about.html" class="header-btn">About</a>
                <a href="generator.html" class="header-btn">Card Generator</a>
                <a href="thankyou.html" class="header-btn">Thank You</a>
            </div>
            <h1>Sleepy Duelist</h1>
            <div style="width: 200px;"><!-- Empty div for balance --></div>
        </div>
    </header>
    
    <main id="pageContent">
        <!-- Home page content will be loaded here -->
    </main>
    
    <footer>
        <p></p>
        <small> I am not affiliated with Konami and do not own or claim any rights to any Konami trademark or the Yu-Gi-Oh! trademark, and all references to such are used for commentary and informational purposes only.</small>
    </footer>
    
    <button class="theme-toggle" id="themeToggle">🌙</button>
    
    <!-- Add notification div -->
    <div id="notification" class="notification"></div>
    
    <!-- Game over overlay -->
    <div id="gameOverOverlay" class="game-over-overlay">
        <div class="game-over-content">
            <h2>Game Over!</h2>
            <p class="difficulty-played" id="difficultyPlayed">Difficulty: Easy</p>
            <p id="finalScoreDisplay">Your final score: 0</p>
            <button id="playAgainButton" class="play-again-btn">Play Again</button>
            <button id="shareScoreButton" class="share-score-btn">Share Score</button>
        </div>
    </div>
    
    <script>
        // Initialize variables
        let score = 0;
        let questionCount = 0;
        let lives = 3;
        let currentDifficulty = 'easy'; // Default difficulty
        let lastScore = null; // Track the last score
        
        // Get notification element
        const notification = document.getElementById('notification');
        
        // Function to show notification
        function showNotification(message, isSuccess) {
            notification.textContent = message;
            notification.className = 'notification ' + (isSuccess ? 'success' : 'error');
            notification.classList.add('show');
            
            // Hide notification after 1.5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 1500);
        }
        
        // Game over function
        function showGameOver() {
            const finalScore = score;
            document.getElementById('finalScoreDisplay').textContent = `Your final score: ${finalScore}`;
            document.getElementById('difficultyPlayed').textContent = `Difficulty: ${currentDifficulty.charAt(0).toUpperCase() + currentDifficulty.slice(1)}`;
            document.getElementById('gameOverOverlay').classList.add('show');
            
            // Save the last score
            lastScore = {
                score: finalScore,
                totalQuestions: questionCount - 1,
                difficulty: currentDifficulty
            };

            // Adds event listener for the share score button
            document.getElementById('shareScoreButton').addEventListener('click', () => {
                const shareableText = generateShareableScore();
                
                // Copy to clipboard
                navigator.clipboard.writeText(shareableText)
                    .then(() => {
                        showCopyNotification();
                    })
                    .catch(err => {
                        console.error('Could not copy text: ', err);
                        alert('Failed to copy to clipboard. Please try again.');
                    });
            });
        }
        
        // Function to get a random card from a list
        function getRandomCard(cardList) {
            const randomIndex = Math.floor(Math.random() * cardList.length);
            return cardList[randomIndex];
        }
        
        // Function to get random unique cards
        function getRandomUniqueCards(cardList, count) {
            const cards = [];
            const usedIndices = new Set();
            
            while (cards.length < count) {
                const randomIndex = Math.floor(Math.random() * cardList.length);
                if (!usedIndices.has(randomIndex)) {
                    usedIndices.add(randomIndex);
                    cards.push(cardList[randomIndex]);
                }
            }
            
            return cards;
        }
        
        // Function to generate lives HTML
        function generateLivesHTML() {
            let livesHTML = '';
            for (let i = 0; i < lives; i++) {
                livesHTML += '<span class="life">❤️</span>';
            }
            return livesHTML;
        }
        
        // Function to create the selection page based on difficulty
        function createSelectionPage() {
            questionCount++;
            
            let selectionBoxesHTML = '';
            let realCardsToShow = 1; // Number of real cards to show
            let optionsCount; // Total number of options
            
            // Set options based on difficulty
            switch (currentDifficulty) {
                case 'easy':
                    optionsCount = 2; // 1 is real, 1 is fake
                    break;
                case 'medium':
                    optionsCount = 3; // 1 is real, 2 are fake
                    break;
                case 'hard':
                    optionsCount = 5; // 1 is real, 4 are fake
                    break;
                default:
                    optionsCount = 2;
            }
            
            // Get random real card(s) - using the imported yugiohCards from external file
            const selectedRealCards = getRandomUniqueCards(yugiohCards, realCardsToShow);
            
            // Get random fake cards - using the imported fakeYugiohCards from external file
            const selectedFakeCards = getRandomUniqueCards(fakeYugiohCards, optionsCount - realCardsToShow);
            
            // Combine all cards and shuffle
            const allCards = [...selectedRealCards, ...selectedFakeCards];
            for (let i = allCards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allCards[i], allCards[j]] = [allCards[j], allCards[i]];
            }
            
            // Create HTML for each card option
            allCards.forEach((card, index) => {
                const isRealCard = selectedRealCards.includes(card);
                selectionBoxesHTML += `
                    <div class="selection-box" id="option${index + 1}" data-is-real="${isRealCard}">
                        <p>${card}</p>
                    </div>
                `;
            });
            
            // Create mobile-friendly controls container
            const controlsHTML = window.innerWidth <= 768 ? 
                `<div class="mobile-controls-container">
                    <button class="menu-btn" id="menuButton">Menu</button>
                    <div class="score-display">Score: ${score}</div>
                    <div class="difficulty-display">Difficulty: ${currentDifficulty.charAt(0).toUpperCase() + currentDifficulty.slice(1)}</div>
                </div>` :
                `<div class="score-display">Score: ${score}</div>
                <div class="difficulty-display">Difficulty: ${currentDifficulty.charAt(0).toUpperCase() + currentDifficulty.slice(1)}</div>
                <button class="menu-btn" id="menuButton">Menu</button>`;
            
            return `
                ${controlsHTML}
                <div class="game-content">
                    <div class="selection-container">
                        ${selectionBoxesHTML}
                    </div>
                    <div class="lives-container">
                        ${generateLivesHTML()}
                    </div>
                </div>
            `;
        }
        
        // Store base page content
        const pages = {
            home: function() {
                let lastScoreHTML = '';
                
                // Add last score section if there's a previous score
                if (lastScore) {
                    lastScoreHTML = `
                        <div class="last-score" style="display: block;">
                            Your last score: ${lastScore.score}
                            (Difficulty: ${lastScore.difficulty.charAt(0).toUpperCase() + lastScore.difficulty.slice(1)})
                        </div>
                    `;
                }
                
                return `
                    <div class="home-container">
                        <h2 class="home-title">TEST Real or Fake: Yu-Gi-Oh! Quiz</h2>
                            
                            <div class="gif-container">
                                <img src="https://i.imgur.com/a6uqaY7.gif" alt="Yu-Gi-Oh Card Animation" class="game-gif">
                            </div>
                        <br>
                        <p style="margin-bottom: 1.5rem; font-size: 1.2rem;">Test your knowledge by identifying real Yu-Gi-Oh! cards! Click on the box with the card's name that you think is real. Good luck!</p>
                        
                        ${lastScoreHTML}
                        
                        <div>
                            <p style="margin-bottom: 1rem; font-size: 1.1rem; font-weight: bold;">Select Difficulty:</p>
                            <div class="difficulty-container">
                                <button id="easyBtn" class="difficulty-btn active">Easy</button>
                                <button id="mediumBtn" class="difficulty-btn">Medium</button>
                                <button id="hardBtn" class="difficulty-btn">Hard</button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1rem; font-size: 0.9rem; color: #666;">
                            <p><strong>Easy:</strong> 2 Options (1 Correct Card)</p>
                            <p><strong>Medium:</strong> 3 Options (1 Correct Card)</p>
                            <p><strong>Hard:</strong> 5 Options (1 Correct Card)</p>
                        </div>
                        
                        <button id="beginButton" class="begin-btn" style="margin-top: 2rem;">Begin</button>
                    </div>
                `;
            },
            selection: createSelectionPage
        };
        
        // Function to handle viewport height issues on mobile
        function setMobileViewportHeight() {
            // First we get the viewport height and multiply it by 1% to get a value for a vh unit
            let vh = window.innerHeight * 0.01;
            // Then we set the value in the --vh custom property to the root of the document
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            // Also check if the content fits within the viewport
            const mainContent = document.getElementById('pageContent');
            if (mainContent) {
                // If we're on the selection page
                const selectionContainer = document.querySelector('.selection-container');
                if (selectionContainer) {
                    // Adjust sizes dynamically based on the number of options and screen height
                    const options = document.querySelectorAll('.selection-box');
                    if (options.length > 0) {
                        // If we have too many options and screen is small, reduce padding even more
                        if (options.length >= 4 && window.innerHeight < 700) {
                            options.forEach(option => {
                                option.style.padding = '0.8rem 0.6rem';
                                option.style.minHeight = '40px';
                            });
                        }
                        // If we have 5 options (hard mode) on a very small screen
                        if (options.length === 5 && window.innerHeight < 600) {
                            options.forEach(option => {
                                option.style.padding = '0.6rem 0.4rem';
                                option.style.minHeight = '35px';
                                option.querySelector('p').style.fontSize = '0.9rem';
                            });
                        }
                    }
                }
            }
        }

        // Call the function initially
        setMobileViewportHeight();

        // Re-calculate on resize and orientation change
        window.addEventListener('resize', setMobileViewportHeight);
        window.addEventListener('orientationchange', () => {
            // Small delay to ensure the browser has updated orientation
            setTimeout(setMobileViewportHeight, 100);
        });

        // Add this to existing event handlers
        window.addEventListener('load', setMobileViewportHeight);

        // Redefine the navigateTo function to include viewport adjustments
        const originalNavigateTo = navigateTo;
        navigateTo = function(page) {
            // Call the original function first
            originalNavigateTo(page);
            
            // Then adjust viewport heights after content is loaded
            setTimeout(setMobileViewportHeight, 50);
            
            // Additional mobile optimizations for specific pages
            if (page === 'selection') {
                // Ensure we're at the top of the page when navigating to a new question
                window.scrollTo(0, 0);
                
                // Add specific optimizations for the option boxes on smaller screens
                const isMobile = window.innerWidth <= 768;
                if (isMobile) {
                    // Optimize touch areas for better mobile interaction
                    const options = document.querySelectorAll('.selection-box');
                    options.forEach(option => {
                        // Ensure touch targets are large enough
                        option.style.minHeight = '50px';
                        
                        // Fix any iOS-specific issues with touch events
                        option.addEventListener('touchstart', function(e) {
                            // Prevent default only if needed to avoid conflicts
                            if (!e.target.closest('input, textarea')) {
                                e.preventDefault();
                            }
                        }, { passive: false });
                    });
                    
                    // Fix iOS momentum scrolling issues in the game content area
                    const gameContent = document.querySelector('.game-content');
                    if (gameContent) {
                        gameContent.style.webkitOverflowScrolling = 'touch';
                    }
                }
            } else if (page === 'home') {
                // Home page specific mobile optimizations
                const isMobile = window.innerWidth <= 768;
                if (isMobile) {
                    // Ensure buttons are properly sized for touch
                    const difficultyBtns = document.querySelectorAll('.difficulty-btn');
                    difficultyBtns.forEach(btn => {
                        btn.style.minWidth = '80px';
                        btn.style.minHeight = '44px';
                    });
                    
                    // Make sure the begin button is prominent and easily tappable
                    const beginBtn = document.getElementById('beginButton');
                    if (beginBtn) {
                        beginBtn.style.minHeight = '50px';
                        beginBtn.style.minWidth = '200px';
                    }
                }
            }
            
            // Handle game over overlay positioning for mobile
            const gameOverOverlay = document.getElementById('gameOverOverlay');
            if (gameOverOverlay) {
                // Use the custom vh variable for better mobile positioning
                gameOverOverlay.style.height = 'calc(var(--vh, 1vh) * 100)';
            }
        };

        // Enhanced touch handling for all interactive elements
        function enhanceTouchInteraction() {
            // Get all interactive elements
            const interactiveElements = document.querySelectorAll('button, .selection-box, .header-btn, .theme-toggle');
            
            interactiveElements.forEach(element => {
                // Remove any existing listeners to prevent duplicates
                element.removeEventListener('touchstart', handleTouchStart);
                element.removeEventListener('touchend', handleTouchEnd);
                
                // Add enhanced touch handlers
                element.addEventListener('touchstart', handleTouchStart, { passive: true });
                element.addEventListener('touchend', handleTouchEnd);
            });
        }

        // Touch handlers with improved feedback
        function handleTouchStart(e) {
            // Add visual feedback class
            this.classList.add('button-active');
            
            // For selection boxes in the game, add extra visual emphasis
            if (this.classList.contains('selection-box')) {
                this.style.transform = 'scale(0.98)';
                this.style.transition = 'transform 0.1s ease-in-out';
            }
        }

        function handleTouchEnd(e) {
            // Remove visual feedback
            this.classList.remove('button-active');
            
            // Reset any additional styles we added
            if (this.classList.contains('selection-box')) {
                this.style.transform = '';
            }
            
            // Prevent default behavior for buttons to avoid delay
            if (this.tagName.toLowerCase() === 'button' || this.classList.contains('selection-box') || this.classList.contains('header-btn')) {
                e.preventDefault();
            }
        }

        // Call the enhanceTouchInteraction function whenever the DOM might have changed
        const observeDOM = (function(){
            const MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
            
            return function(obj, callback){
                if(!obj || obj.nodeType !== 1) return; 
                
                if(MutationObserver){
                    // Define a new observer
                    const mutationObserver = new MutationObserver(callback);
                    
                    // Have the observer observe the element for changes in children
                    mutationObserver.observe(obj, { childList:true, subtree:true });
                    return mutationObserver;
                }
                // No MutationObserver support, fall back to DOMNodeInserted
                else if(window.addEventListener){
                    obj.addEventListener('DOMNodeInserted', callback, false);
                    obj.addEventListener('DOMNodeRemoved', callback, false);
                }
            };
        })();

        // Observe changes to the page content and enhance touch interactions
        observeDOM(document.getElementById('pageContent'), function(mutations) {
            // Add a small delay to ensure the DOM is fully updated
            setTimeout(enhanceTouchInteraction, 50);
        });

        // Fix iOS-specific issues
        function fixIOSIssues() {
            // Check if we're on iOS
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            
            if (isIOS) {
                // Add iOS-specific class to body
                document.body.classList.add('ios-device');
                
                // Fix for iOS input focusing issues
                const inputs = document.querySelectorAll('input, textarea');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        // Add padding to bottom of page to prevent content from being hidden behind keyboard
                        document.body.style.paddingBottom = '150px';
                    });
                    
                    input.addEventListener('blur', function() {
                        // Remove padding when keyboard is hidden
                        document.body.style.paddingBottom = '0';
                    });
                });
                
                // Fix for double-tap zoom on buttons
                const allButtons = document.querySelectorAll('button, .selection-box, .header-btn');
                allButtons.forEach(button => {
                    button.style.touchAction = 'manipulation';
                });
            }
        }

        // Call iOS fixes on page load
        window.addEventListener('load', fixIOSIssues);

        // Enhanced feedback for copy notification
        function showCopyNotification() {
            // Create if it doesn't exist
            let copyNotification = document.getElementById('copyNotification');
            if (!copyNotification) {
                copyNotification = document.createElement('div');
                copyNotification.id = 'copyNotification';
                copyNotification.className = 'copy-notification';
                copyNotification.textContent = 'Score copied to clipboard!';
                document.body.appendChild(copyNotification);
            }
            
            // Show notification with enhanced animation
            copyNotification.classList.add('show');
            copyNotification.style.animation = 'none'; // Reset animation
            setTimeout(() => {
                copyNotification.style.animation = 'copyFadeIn 0.3s ease-in-out';
            }, 10);
            
            // Hide after delay
            setTimeout(() => {
                copyNotification.style.animation = 'copyFadeOut 0.3s ease-in-out';
                setTimeout(() => {
                    copyNotification.classList.remove('show');
                }, 300);
            }, 2000);
        }

        // Add this to the document head to support the animation
        const style = document.createElement('style');
        style.textContent = `
        @keyframes copyFadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        @keyframes copyFadeOut {
            from { opacity: 1; transform: translate(-50%, -50%); }
            to { opacity: 0; transform: translate(-50%, -60%); }
        }
        `;
        document.head.appendChild(style);

        // Call all these enhancements when the page loads
        window.addEventListener('DOMContentLoaded', function() {
            setMobileViewportHeight();
            enhanceTouchInteraction();
            fixIOSIssues();
            
            // Set up the copy notification
            if (!document.getElementById('copyNotification')) {
                const copyNotification = document.createElement('div');
                copyNotification.id = 'copyNotification';
                copyNotification.className = 'copy-notification';
                copyNotification.textContent = 'Score copied to clipboard!';
                document.body.appendChild(copyNotification);
            }
        });
        // Function to navigate between pages
        function navigateTo(page) {
            const pageContent = document.getElementById('pageContent');
            
            // Update selection page content with new cards if needed
            if (page === 'selection') {
                pageContent.innerHTML = createSelectionPage();
            } else if (page === 'home') {
                // Use the function to get dynamic home content with last score
                pageContent.innerHTML = pages.home();
            }
            
            // Add event listeners after page content is loaded
            if (page === 'home') {
                // Add event listeners for difficulty buttons
                document.getElementById('easyBtn').addEventListener('click', () => {
                    setDifficulty('easy');
                });
                
                document.getElementById('mediumBtn').addEventListener('click', () => {
                    setDifficulty('medium');
                });
                
                document.getElementById('hardBtn').addEventListener('click', () => {
                    setDifficulty('hard');
                });
                
                document.getElementById('beginButton').addEventListener('click', () => {
                    // Reset score when starting a new game
                    score = 0;
                    questionCount = 0;
                    lives = 3;
                    navigateTo('selection');
                });
                
                // Add touch event listeners for buttons on the home page
                addTouchListeners([
                    'easyBtn', 'mediumBtn', 'hardBtn', 'beginButton'
                ].map(id => document.getElementById(id)));
                
            } else if (page === 'selection') {
                // Add click event for menu button
                document.getElementById('menuButton').addEventListener('click', () => {
                    navigateTo('home');
                });
                
                // Add touch event listener for menu button
                addTouchListeners([document.getElementById('menuButton')]);
                
                // Add click events for all option boxes
                const options = document.querySelectorAll('.selection-box');

                // Global variable to track processing state
                    let isProcessing = false;
                    
                    // Function to handle option box clicks
                    function handleOptionClick(option, allOptions) {
                        // Prevent multiple clicks while processing an answer
                        if (isProcessing) return;
                        
                        // Set flag to prevent further clicks
                        isProcessing = true;
                        
                        // Disable all option boxes visually
                        allOptions.forEach(opt => {
                            opt.style.pointerEvents = 'none';
                            opt.style.opacity = '0.7';
                        });
                        
                        const isRealCard = option.getAttribute('data-is-real') === 'true';
                        
                        if (isRealCard) {
                            // If correct
                            score++;
                            option.style.backgroundColor = '#9ee2a2'; // Green background
                            option.style.borderColor = '#2e6934'; // Dark green border
                            showNotification('Correct! That is a real card!', true);
                        } else {
                            // If incorrect
                            lives--;
                            option.style.backgroundColor = '#ffb7c5'; // Pink background
                            option.style.borderColor = '#993344'; // Dark pink border
                            
                            // Find and highlight the correct answer
                            allOptions.forEach(opt => {
                                if (opt.getAttribute('data-is-real') === 'true') {
                                    opt.style.backgroundColor = '#9ee2a2'; // Green background
                                    opt.style.borderColor = '#2e6934'; // Dark green border
                                    
                                    // Add a "Real Card" label
                                    const realCardLabel = document.createElement('div');
                                    realCardLabel.textContent = '✓ Real Card';
                                    realCardLabel.style.color = '#2e6934';
                                    realCardLabel.style.fontWeight = 'bold';
                                    realCardLabel.style.marginTop = '10px';
                                    opt.appendChild(realCardLabel);
                                }
                            });
                            
                            showNotification('Incorrect! That is NOT a real card!', false);
                            
                            // Check if out of lives
                            if (lives <= 0) {
                                showGameOver();
                                return;
                            }
                        }
                        
                        // Longer delay before loading new question to allow player to see the correct answer
                        setTimeout(() => {
                            navigateTo('selection'); // Load new cards
                            isProcessing = false; // Reset processing flag for next question
                        }, 1800); // Increased from 1000ms to 2000ms
                    }
                
                    // Add click event listeners to all option boxes
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        handleOptionClick(this, options);
                    });
                    
                    // Add touch events for mobile devices
                    option.addEventListener('touchstart', function(e) {
                        this.classList.add('button-active');
                    }, { passive: true });
                    
                    option.addEventListener('touchend', function(e) {
                        e.preventDefault(); // Prevent default behavior
                        this.classList.remove('button-active');
                        handleOptionClick(this, options);
                    });
                });
                
                // Add the selection boxes to the touch listeners collection
                addTouch
                
                }
            }

        

        // Function to add touch event listeners to elements
        function addTouchListeners(elements) {
            elements.forEach(element => {
                if (!element) return; // Skip null elements
                
                // Remove existing touch listeners to prevent duplicates
                element.removeEventListener('touchstart', touchStartHandler);
                element.removeEventListener('touchend', touchEndHandler);
                
                // Add touch event listeners
                element.addEventListener('touchstart', touchStartHandler, { passive: true });
                element.addEventListener('touchend', touchEndHandler);
            });
        }

        // Touch event handlers
        function touchStartHandler(e) {
            this.classList.add('button-active');
        }

        function touchEndHandler(e) {
            e.preventDefault(); // Prevent default to avoid delay
            this.classList.remove('button-active');
            
            // If this is a selection box, handle the click logic
            if (this.classList.contains('selection-box')) {
                const options = document.querySelectorAll('.selection-box');
                handleOptionClick(this, options, isProcessing);
            } else {
                // For other buttons, trigger a click event
                this.click();
            }
        }

        // Improved event initialization
        window.addEventListener('load', () => {
            // Check if card lists are available, if not show error
            if (typeof yugiohCards === 'undefined' || typeof fakeYugiohCards === 'undefined') {
                console.error('Card lists not found! Make sure cardLists.js is properly loaded.');
                alert('Error: Card lists not loaded. Please check the console for more information.');
            } else {
                navigateTo('home');
                
                // Add touch event listener for theme toggle
                addTouchListeners([document.getElementById('themeToggle')]);
                
                // Add touch event listener for play again button
                addTouchListeners([document.getElementById('playAgainButton')]);
                
                // Add touch event listener for share score button
                addTouchListeners([document.getElementById('shareScoreButton')]);
            }
            
            // Add touchscreen detection class to body
            if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
                document.body.classList.add('touchscreen');
            }
        });

        // Modified play again button event handler
        document.getElementById('playAgainButton').addEventListener('click', () => {
            document.getElementById('gameOverOverlay').classList.remove('show');
            navigateTo('home');
        });

        // Modified share score button event handler
        document.getElementById('shareScoreButton').addEventListener('click', () => {
            const shareableText = generateShareableScore();
            
            // Copy to clipboard
            navigator.clipboard.writeText(shareableText)
                .then(() => {
                    showCopyNotification();
                })
                .catch(err => {
                    console.error('Could not copy text: ', err);
                    alert('Failed to copy to clipboard. Please try again.');
                });
        });
        // Function to set difficulty
        function setDifficulty(difficulty) {
            currentDifficulty = difficulty;
            
            // Update active button styling
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${difficulty}Btn`).classList.add('active');
        }
        
        // Add event listener for play again button
        document.getElementById('playAgainButton').addEventListener('click', () => {
            document.getElementById('gameOverOverlay').classList.remove('show');
            navigateTo('home');
        });
        
        // Load home page on initial load
        window.addEventListener('load', () => {
            // Check if card lists are available, if not show error
            if (typeof yugiohCards === 'undefined' || typeof fakeYugiohCards === 'undefined') {
                console.error('Card lists not found! Make sure cardLists.js is properly loaded.');
                alert('Error: Card lists not loaded. Please check the console for more information.');
            } else {
                navigateTo('home');
            }
        });
        
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        
        // Check for saved theme preference or use preferred color scheme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            body.classList.add('dark-theme');
            themeToggle.textContent = '☀️';
        } else if (savedTheme === 'light') {
            body.classList.remove('dark-theme');
            themeToggle.textContent = '🌙';
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            body.classList.add('dark-theme');
            themeToggle.textContent = '☀️';
        }
        
        // Toggle theme
        themeToggle.addEventListener('click', () => {
            if (body.classList.contains('dark-theme')) {
                body.classList.remove('dark-theme');
                themeToggle.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.add('dark-theme');
                themeToggle.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            }
        });


        function generateShareableScore() {
            const finalScore = score;
            const totalQuestions = questionCount;
            const difficultyText = currentDifficulty.charAt(0).toUpperCase() + currentDifficulty.slice(1);
            
            // Choose emoji based on difficulty
            let difficultyEmoji;
            switch(currentDifficulty) {
                case 'easy':
                    difficultyEmoji = '🟢'; // Green circle for easy
                    break;
                case 'medium':
                    difficultyEmoji = '🟡'; // Yellow circle for medium
                    break;
                case 'hard':
                    difficultyEmoji = '🔴'; // Red circle for hard
                    break;
                default:
                    difficultyEmoji = '⚪'; // White circle for default
            }
            
        
            
            // Generate emoji pattern based on score
            let emojiPattern = '';
            if (finalScore >= 90) {
                emojiPattern = '⭐⭐⭐⭐⭐';
            } else if (finalScore >= 50) {
                emojiPattern = '⭐⭐⭐⭐';
            } else if (finalScore >= 30) {
                emojiPattern = '⭐⭐⭐';
            } else if (finalScore >= 10) {
                emojiPattern = '⭐⭐';
            } else {
                emojiPattern = '⭐';
            }
            
            // Create shareable text
            const shareText = `Sleepy Duelist Quiz ${difficultyEmoji}\nScore: ${finalScore}\n${emojiPattern}\nPlay at: sleepyduelist.xyz`;
            
            return shareText;
        }

        function showCopyNotification() {
            const copyNotification = document.getElementById('copyNotification');
            copyNotification.classList.add('show');
            
            setTimeout(() => {
                copyNotification.classList.remove('show');
            }, 2000);
        }

        //Mobile Improvements
        // Function to handle viewport height issues on mobile
        function setMobileViewportHeight() {
            // Set the --vh custom property to the viewport height
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        // Call the function initially
        setMobileViewportHeight();

        // Re-calculate on resize and orientation change
        window.addEventListener('resize', setMobileViewportHeight);
        window.addEventListener('orientationchange', setMobileViewportHeight);

        // Improve touch interactions
        document.addEventListener('DOMContentLoaded', function() {
            // Remove 300ms delay on mobile devices
            document.addEventListener('touchend', function(event) {
                if (event.target.tagName.toLowerCase() === 'button' ||
                    event.target.classList.contains('selection-box') ||
                    event.target.closest('.selection-box')) {
                    event.preventDefault();
                }
            }, false);
            
            // Add active state for touch feedback on buttons
            const buttons = document.querySelectorAll('button, .selection-box');
            
            buttons.forEach(button => {
                button.addEventListener('touchstart', function() {
                    this.classList.add('button-active');
                });
                
                button.addEventListener('touchend', function() {
                    this.classList.remove('button-active');
                });
            });
            
            // Fix iOS input issues
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('touchstart', function(e) {
                    e.stopPropagation();
                });
            });
        });

        // Function to reposition game elements based on screen size
        function repositionGameElements() {
            const isMobile = window.innerWidth <= 768;
            const gameContent = document.querySelector('.game-content');
            
            if (gameContent) {
                if (isMobile) {
                    // Rearrange elements for mobile layout
                    const menuBtn = document.getElementById('menuButton');
                    const scoreDisplay = document.querySelector('.score-display');
                    const difficultyDisplay = document.querySelector('.difficulty-display');
                    
                    if (menuBtn && scoreDisplay && difficultyDisplay) {
                        // Move elements to the start of game content
                        gameContent.prepend(difficultyDisplay);
                        gameContent.prepend(scoreDisplay);
                        gameContent.prepend(menuBtn);
                    }
                }
            }
        }

        // Call this function when loading the selection page
        function enhancedNavigateTo(page) {
            // Original navigateTo code here...
            
            // Then add:
            if (page === 'selection') {
                // Allow a small delay for the DOM to update
                setTimeout(repositionGameElements, 50);
            }
            
            // Fix for mobile scrolling to top on new question
            window.scrollTo(0, 0);
        }

        // Add a touchscreen detection class to body
        if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
            document.body.classList.add('touchscreen');
        }
    </script>

    <div id="copyNotification" class="copy-notification">Score copied to clipboard!</div>

</body>
</html>